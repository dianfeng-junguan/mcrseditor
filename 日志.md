# qucs2nbt

## 2024年12月22日

今天大开发，完成了很多功能。

之后计划：

- 通过sch文件获取有哪些模块实体
- 通过sch文件获取模块实体连接关系
- 从nbt库中加载相应功能的结构，放置在地图中
- 根据连接关系连接端口
- 生成nbt文件

## 2024年12月26日

寻路部分太慢，计划之后用更快的算法

## 2024年12月28日

寻路用了a*。

之后有空把部件和连线规划写得好一点。

现在直接就是用寻路两两连接端口，这不好，可以试试总线连接法，把相连的几个端口全部引到一个总线上面去，而不是直接互相连接。

门电路的放置也要优化，目前只是简单的排成一行，之后尽量方阵排列

代码之后改得可读性高点。

目前生成的nbt没法在mc里面放出来，这个bug待修。

## 2024年12月29日

目前可以在mc中放置电路了，但是有部分端口连接还是有一点问题。

以及这个自己写的脚本也是非常的不完备，接下来先把脚本先提升一下好了。

这几乎是要自己写编译器了……

也可以先退而求其次，先把json的解析生成nbt部分改进一下。

- and, or只有两输入，not一输入, port一输入，全部只有一输出
- 端口不强求有连接，这样就不需要port这个东西了。
- json目前先手写

## 2025年1月1日

检查了一下，发现连红石线的部分还是有问题的，两点确定之后的红石线会发生偏移。等待以后修正。

之前的代码大多是极限短时间写出来的，所以会比较乱，之后会慢慢整理成一个好一点的样子，之前写的自动寻路生成的那部分会收在一个文件夹里面，之后就不开发那个了。

之后会考虑添加网格绘制和更大的地图（移动视野）

然后可能会添加把一个电路打包成一个元件的功能，不过这之前还要解决超越结构方块48x48x48限制的问题。

之后会开源代码到github。

忍到期末考结束就可以开始动工了。

之后还会遇到的一个问题是，线路之间会交叉，为了交叉但是不会互相干扰，在生成的时候就需要生成跨越电路，其实就是抬高一下。然后还需要一个标记此处“就是要交叉相连”的功能。

当然，这些完成之后可以考虑一下脚本生成这些电路，就是只给定元件的连接关系，但是不指定他们的位置，让软件安排位置。这样之前写的代码就可以用上了。